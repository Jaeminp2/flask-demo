<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Todo List</title>
</head>

<form method="get" action="{{ url_for('todo.todos') }}">
  <label>Filter by:
    <select name="category" onchange="this.form.submit()">
      <option value="">All</option>
      {% for c in categories %}
        <option value="{{ c.id }}"
          {% if c.id == selected %}selected{% endif %}>
          {{ c.name }}
        </option>
      {% endfor % }
    </select>
  </label>
</form>

<body>
  <h1>Todo List</h1>
  <ul>
    {% for t in todos %}
      <li style="list-style:none;">
        <form method="post"
              action="{{ url_for('todo.toggle', todo_id=t.id) }}"
              style="display:inline;">
          <input type="checkbox"
                 onChange="this.form.submit()"
                 {% if t.completed %}checked{% endif %}>
        </form>
        <span {% if t.completed %}style="text-decoration:line-through;"{% endif %}>
          {{ t.text }}
        </span>
      </li>
    {% endfor %}
  </ul>

  <form method="post">
    <input type="text" name="todo" placeholder="Enter new todo" required>
    <select name="category_id">
      <option value="">No category</option>
      {% for c in categories %}
        <option value="{{ c.id }}">{{ c.name }}</option>
      {% endfor %}
    </select>
    <input type="submit" value="Add Todo">
  </form>

  <br><a href="/">Back to Home</a>
</body>
</html>